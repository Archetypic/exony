From f0bb19b2fe0e5c2c5ca5fb223ac9bdb37b7893f0 Mon Sep 17 00:00:00 2001
From: Nikolay Orlyuk <virkony@gmail.com>
Date: Sat, 7 Jul 2012 23:36:07 +0300
Subject: [PATCH 3/3] Add man, info and lisp dirs configuring (bug259)

See http://bugs.mercury.csse.unimelb.edu.au/view.php?id=259
---
 configure.in          |  3 +++
 scripts/Mmake.vars.in | 19 +++++++++++++------
 2 files changed, 16 insertions(+), 6 deletions(-)

diff --git a/configure.in b/configure.in
index bdc6427..3cdf657 100644
--- a/configure.in
+++ b/configure.in
@@ -1164,6 +1164,9 @@ AC_SUBST(LINK_OPT_SEP)
 AC_SUBST(FIX_PATH_FOR_CC)
 AC_SUBST(CYGPATH)
 
+lispdir='${datarootdir}/emacs/site-lisp'
+AC_SUBST(lispdir)
+
 #-----------------------------------------------------------------------------#
 # Check for `-lm': some systems, e.g. MacOS X (Darwin), don't have it.
 # The result of this check may be overridden below.
diff --git a/scripts/Mmake.vars.in b/scripts/Mmake.vars.in
index e5d782a..4d8224e 100644
--- a/scripts/Mmake.vars.in
+++ b/scripts/Mmake.vars.in
@@ -691,30 +691,37 @@ else
     DESTDIR_AND_SLASH=$(DESTDIR)/
 endif
 
+# autoconf provided vars
 prefix = @prefix@
 exec_prefix = @exec_prefix@
 libdir = @libdir@
+datarootdir = @datarootdir@
+mandir = @mandir@
+infodir = @infodir@
+lispdir = @lispdir@
+
+# actual vars used for installation
 
 INSTALL_PREFIX		= $(DESTDIR_AND_SLASH)$(prefix)
 INSTALL_BINDIR		= $(INSTALL_PREFIX)/bin
 INSTALL_LIBDIR		= $(DESTDIR_AND_SLASH)$(libdir)/mercury
-INSTALL_INFO_DIR	= $(INSTALL_PREFIX)/info
+INSTALL_INFO_DIR	= $(infodir)
 INSTALL_DVI_DIR		= $(INSTALL_LIBDIR)/doc
 INSTALL_TEXT_DIR	= $(INSTALL_LIBDIR)/doc
 INSTALL_PS_DIR		= $(INSTALL_LIBDIR)/doc
 INSTALL_PDF_DIR		= $(INSTALL_LIBDIR)/doc
-INSTALL_MAN_DIR		= $(INSTALL_PREFIX)/man
+INSTALL_MAN_DIR		= $(DESTDIR_AND_SLASH)$(mandir)
 INSTALL_HTML_DIR	= $(INSTALL_LIBDIR)/html
 INSTALL_MDB_DOC_DIR	= $(INSTALL_LIBDIR)/mdb
-INSTALL_ELISP_DIR	= $(INSTALL_LIBDIR)/elisp
+INSTALL_ELISP_DIR	= $(DESTDIR_AND_SLASH)$(lispdir)
 INSTALL_CGI_DIR		= $(DESTDIR_AND_SLASH)@CGIDIR@
 
 FINAL_INSTALL_PREFIX	= $(prefix)
 FINAL_INSTALL_BINDIR 	= $(FINAL_INSTALL_PREFIX)/bin
 FINAL_INSTALL_LIBDIR	= $(libdir)/mercury
-FINAL_INSTALL_INFO_DIR	= $(FINAL_INSTALL_PREFIX)/info
-FINAL_INSTALL_MAN_DIR	= $(FINAL_INSTALL_PREFIX)/man
-FINAL_INSTALL_ELISP_DIR	= $(FINAL_INSTALL_LIBDIR)/elisp
+FINAL_INSTALL_INFO_DIR	= $(infodir)
+FINAL_INSTALL_MAN_DIR	= $(mandir)
+FINAL_INSTALL_ELISP_DIR	= $(lispdir)
 FINAL_INSTALL_CGI_DIR	= @CGIDIR@
 
 # You should not need to override anything below here
-- 
1.8.0.3

